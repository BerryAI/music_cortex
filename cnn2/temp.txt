from os import listdir

def obtain_mp3_name(filepath):
    '''use os.dirlist() to read all mp3 file names
       :param filename: filename of the song preview file
       :return namelist: all mp3 file name and dir
       :rtype: list
       :Author: Chris Hu
    '''
    #read all file names in list m
    #filepath='/home/share/MillionSongSubset/download/'
    filename_list = listdir(filepath)
    name_list = []
    #check last 3 char to ensure mp3 files
    for filename in filename_list:
        if filename[-3:]=='mp3':
            name_list.append(filepath+filename)#add into list if mp3 file
    return name_list

import librosa

def extract_acoustic_feature(input_file,
                             num_mfcc = 128,
                             number_mels = 128,
                             frequency_max = 8000):
    """ Load the music file
        Extract Mel Frequency Cepstrum Coefficient
        :return feature: a matrix contains extracted mfcc
        :Author: Chris Hu
    """
    #load music from librosa example
    try:
        y,sr = librosa.load(input_file)
    except:
        print("File loading error")
        return 0   
    #feature extraction(mfcc)
    #librosa.feature.mfcc(y=y, sr=sr)  
    #log-power Mel spectrogram
    S = librosa.feature.melspectrogram(y = y, sr = sr,
                                       n_mels = number_mels,
                                       fmax = frequency_max)
    #feature extraction(mfcc)
    feature = librosa.feature.mfcc(S = librosa.logamplitude(S),
                                   n_mfcc = num_mfcc)  
    return feature

name_list = obtain_mp3_name('/home/share/MillionSongSubset/download/')